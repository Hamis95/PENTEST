#H4

**z)**

Ensimmäiseksi katsoin Ippsec videon "buff" koneen murtamisesta
* Koneella pyöri portissa 8080 http sivu
* Sivulla pyöri fitness sivusto, johon käytettiin ohjelmaa **gobuster**
* Sivulla käytettiin vanhaa softaa "gym management system", jolle löytyi exploitti ohjelmalla **searchsploit**
* koneen hallinnassa käytettiin msfvenom
[Lähde1](https://www.youtube.com/watch?v=-KBm3tBNK74)

Seuraavaksi katsoin Ippsec videon "remote" koneen murtamisesta
* koneella oli auki FTP, SMB ja NSF portit
* walkthroughssa käytettiin työkaluja **crackmapexec ja winpeas**
* koneella pyörivälle nettisivulle pääsi sisään hyödyntämällä umbracon haavoittuvuutta, jolla salasanojen hashit saatiin näkyviin.
* salasana oli sha1 enkoodattu
* hashauksen purkuun käytettiin **john the ripperiä**

[Lähde2](https://www.youtube.com/watch?v=iyYqgseKUPM)

Seuraavaksi luin walkthroughn "tabby" koneen murtamisesta
* portit: TCP ports, SSH (22), HTTP Apache (80), and HTTP Tomcat (8080) olivat auki
* nettisivun hostaaja on "mega hosting" ja sivulla pyörii php
* reverse shell hankittiin msfvenom ohjelmalla
* shellissä selailemalla näkee että käyttäjä ash omistaa tiedoston backup.zip
* hascatin avulla salasana saatiin hashattyä tiedostosta ja näin kirjauduttiin ash käyttäjälle
* ashin oikeuksiin kuuluvaan konttiin laitettiin pyörimään lxc exploitti, jolla rootin directory saatiin luettavaksi

[Lähde3](https://0xdf.gitlab.io/2020/11/07/htb-tabby.html)

Seuraavaksi luin walkthroughn "blunder" koneen murtamisesta
* koneella auki portit SSH (22) ja HTTP (9001)
* http sivulla pyörii blogisivusto
* gobuster löysi /admin/ directoryn, jossa on buildit sisäänkirjautumisportaali sivuston muokkaukseen
* searchsploitista löytyy haavoittuvuus buildittiin
* php exploit löytää hugo käyttäjän ja sha1 hashatun salasanan
* blunderin vanha versio antaa keinon kirjautua roottiin käyttäjä id "-1"

[Lähde4](https://0xdf.gitlab.io/2020/10/17/htb-blunder.html

**a)**

Luin enemmänkin walkthrough artikkeleja ja niistä paljastui kiinnostavia työkaluja
Otin tähän tehtävään kohteeksi HTB koneen ```10.10.10.195```, koska koneella pyörii http palvelin ja nettisivu.

Ensimmäiseksi työkalu nimeltään **gobuster**, joka tutkii nettisivun mahdolliset directoryt bruteforce menetelmällä. 

Käskyllä ```$ gobuster dir -u http://10.10.10.195/ -w common.txt```

![nampb](https://github.com/Hamis95/PENTEST/blob/main/gobuster.png?raw=true)

gobuster löysi siis directoryn **/admin/**
gobuster toimii hyvin samalla tavalla kun dirbuster, mutta gobuster on himan kevyempi käyttää. Sopii hyvin virtuaalikoneelle. Latasin myös sanalistan githubista wgetillä. Olisin voinut myös käyttää dirbusterin valmista word listaa, mutta halusin kokeilla toisella.

Toinen työkaluni on nimeltään **Nikto**. Tämä työkalu löytyy valmiiksi asennettuna kali linuxilta
Nikto skannaa web-serveriltä haavoittuvuuksi etsimällä vanhoja ohjelmaversioita/protocollia ja kertoo mahdolliset **OSVDB** haavoittuvuudet ja niiden numerot.

Käskyllä ```$ nikto -h 10.10.10.195``` nikto listaa osoitteella pyörivän http-palvelimen mahdolliset haavoittuvuudet

![nampb](https://github.com/Hamis95/PENTEST/blob/main/nikto.png?raw=true)

ainoa haavoittuvuus, jonka nikto löysi kohteesta oli **OSVDB-3126: /submit?setoption=q&option=allowed_ips&value=255.255.255.255: MLdonkey 2.x allows administrative interface access to be access from any IP. This is typically only found on port 4080**

Kolmas työkaluni on nimeltään **owasp-zap**. Se tutkii nettisivun mahdolisia haavoittuvuuksi graafisella käyttöliittymällä.
Testasin sivun "http://10.10.10.195" haavoittuvuudet tällä työkalulla. Ohjelma lähettää kohdesivulle erilaisia GET ja POST pyyntöjä ja tulostaa niiden vastaukset.

![nampb](https://github.com/Hamis95/PENTEST/blob/main/owasp-zap.png?raw=true)

Neljäntenä ohjelmana käytän **john the ripperiä**, joka purkaa salasanojen hashauksia. Tein siis pienen testin, mutta en purkanut salasanoja loppuun. Tässä olisi mennyt liian kauan aikaa ja tietokoneen tuulettimet alkoivat kuulostaa boeing 747 lentokoneelta.
Kopioin siis oman järjestelmäni salasanatiedoston **hash.txt** tiedostoon ja pistin johnin pyövelöimään käskyllä ```$ john hash.text```

![nampb](https://github.com/Hamis95/PENTEST/blob/main/johntheripper.png?raw=true)


Tulosta ei siis tullut, mutta ohjelma toimi.


Viides työkaluni on **wfuzz** sen idea on bruteforcaa webbi aplikaatioita syöttämällä random dataa.
Pistin wfuzzin hyökkäämään osoitteeseen ```10.10.10.195```

![nampb](https://github.com/Hamis95/PENTEST/blob/main/wfuzz.png?raw=true)


**b)**

Tutkin tehtävässä koneet Ropetwo, openkeys, unbalanced, laser ja worker.

Käytän kaikissa kohteissa käskyä ```$ sudo nmap -sC -sV -oA recon -p- -T4 -v 10.10.10.xxx```, jotta saan mahdollisimman paljon tietoa nmapin avulla.

**1.RopeTwo**

Aloitan tiedustelun käskyllä ```$ sudo nmap -sC -sV -oA recon -p- -T4 -v 10.10.10.196```

![nampb](https://github.com/Hamis95/PENTEST/blob/main/ropetwo.png?raw=true)

Mitä tulostuksesta saa selville:
* Koneen käyttöjäjestelmä on Linux Ubuntu
* Koneella ovat auki portit 22(SSH), 5000(http-nginx), 8000(http-werkzeug), 8060(nginx) ja 9094(nginx)
* Portin 22 ssh palvelu on OpenSSH 7.9p1
* Portteja 5000, 8060 ja 9094 kuuntelevan nginx palvelun versio on 1.14.2
* Portin 8000 werkzeug ohjelmassa pyörii Python/3.7.3. Werkzeug on webbiaplikaation kirjasto
* Portti 9094 on auki, mutta sitä kuuntelevaa palvelua ei pystytty tunnistamaan
* nettisivut tukevat GET, POST ja HEAD pyyntöjä

Searchsploitilla nginx:stä löytyi muutama haavoittuvuus, sillä versio 1.14.2 on erittäin vanha.
Haavoittuvuuksissa oli Chuncked Encoding Stack Buffer Overflow (Metasploit) ja Denial of Service (PoC), joten kone on haavoittuvainen metasploitille ja PoC dosille.
OpenSSH oli sen verran ajantasalla että searchsploitista ei ainakaan löytynyt siihe haavoittuvuutta.

**2.OpenKeyS**

Aloitan tiedustelun käskyllä ```$ sudo nmap -sC -sV -oA recon -p- -T4 -v 10.10.10.199```

![nampb](https://github.com/Hamis95/PENTEST/blob/main/OpenKeyS.png?raw=true)

Mitä tulostuksesta saa selville:
* Käyttöjärjestelmänä koneessa toimii UNIX pohjainen OpenBSD
* Koneessa on auki portit 22(ssh) ja 80(http)
* Portti 80 kuuntelee OpenBSD:n http palvelu, josta ei tulostunut versionumeroa
* Portti 22 palvelu on OpenSSH, jonka versio on 8.1 ja protokolla 2
* Koneessa on suuri määrä filtteröityjä portteja
* http palvelin tukee GET ja HEAD pyyntöjä, mutta ei POST

Koneessa pyörii annettujen tietojen mukaan aika harvinainen käyttöjärjestelmä. HTTP palvelun versiota ei saada selville, joka voi johtua juuri tästä syystä.
OpenSSH palvelun versio on aika uusi ja siihen ei löydy searchsploitista haavoittuvuuksia.
OpenBSD järjestelmässä on omat haavoittuvuutensa, mutta koska järjestelmän versiota ei ole tiedossa niin näitä on vaikea etsiä.

**3.Unbalanced**

Aloitan tiedustelun käskyllä ```$ sudo nmap -sC -sV -oA recon -p- -T4 -v 10.10.10.200```

![nampb](https://github.com/Hamis95/PENTEST/blob/main/Unbalanced.png?raw=true)

Mitä tulostuksesta saa selville:
* Koneessa toimii käyttöjärjestelmänän Linux Debian 10
* Koneessa on auki portit 22(SSH), 873(rsync) ja 3128(http-proxy)
* Porttia 22 kuuntelee OpenSSH versio 7.9p1
* Porttia 873 kuuntelee rsync protokolla versio 31. rsync on tiedostojen kopiointi- ja siirtämistyökalu
* Porttia 3128 kuuntelee squid http proxy versio 4.6

Googlettamalla rsync protokolla 31 sain ymmärretyksi, että protokolla 31 tarkoittaa versiota 3.1.xxx. Tein siis searchsploit haun versiolle 3.1. ja kävi ilmi, että tälle versiolle ei ole tunnettuja haavoittuvuuksia.
Myös squid 4.6 palvelu oli tarpeeksi uusi välttämään tunnetut haavoittuvuudet. Sama juttu OpenSSH 7.9p1 kanssa


**4.Laser**

Aloitan tiedustelun käskyllä ```$ sudo nmap -sC -sV -oA recon -p- -T4 -v 10.10.10.201```

![nampb](https://github.com/Hamis95/PENTEST/blob/main/Laser.png?raw=true)


Mitä tulostuksesta saa selville:
* Koneessa toimii käyttöjärjestelmänä Linux Ubuntu 4
* Koneessa ovat auki portit 22(SSH), 9000(cslistener) ja 9100(jetdirect)
* nmap ei ole varma että ovatko cslistener ja jetdirect varmasti portteja kuuntelevat ohjelmat. Nämä ovat vain näiden ohjelmien yleisimmät portit
* nmap tulostaa toisen palvelun fingerprintin, jota voi hyödyntää palvelun tunnistamisessa
* tähän on myös printtaantunut SSH hostkeyt. Näitä voi hyödyntää erilaisissa skripteissä, mutta ne eivät suoraan aiheuta haavoittuvuutta koneelle, sillä ne ovat tarkoituksella julkisia

Näillä tiedoilla ei löydy searchsploitista sopivia haavoittuvuuksia

**5.Worker**

Aloitan tiedustelun käskyllä ```$ sudo nmap -sC -sV -oA recon -p- -T4 -v 10.10.10.203```

![nampb](https://github.com/Hamis95/PENTEST/blob/main/Worker.png?raw=true)

Mitä tulostuksesta saa selville:
* Koneessa käyttöjärjestelmänä toimii Windows server
* Koneessa ovat auki portit 80(http), 3690(svnverse) ja 5985(httpapi)
* HTTP palvelun versio on Microsoft IIS httpd 10.0
* Portissa 5985 toimiva palvelu on Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) 

Osoitteen sivulla käydessä se ilmenee olevansa microsoftin info sivu, joka ohjaa klikattua linkkejä microsoftin itso hostaamille sivuille. IIS 10 löytyi googlettamalla muutava haavoittuvuus liittyen puskurien ylivuotoon, mutta searchsploitista ei löytynyt valmista pakettia.
svnservelle löytyy searchsploitista suoraan metasploitti. 



**c)**

**[HTB:Sauna walkthrough](https://0xdf.gitlab.io/2020/07/18/htb-sauna.html)**

* Tässä walkthrougssa hyökätään htb koneeseen jossa pyörii nettisivu http portissa 80. 
* Nettisivun directoria aletaan murtamaan **gobuster** työkalulla 
* Koska portti 445 on auki niin SMB mappaus tehdään myös
* Käyttäjänimiä brute forcattiin **kerberos** työkalulla

Laitoin tätä tehtävää simuloiden dirbusterin pyörimään ```10.10.10.206``` koneen http palveluun, koska halusin kokeilla tätä vaihtoehtoa.
Dirbusterissa on helppokäyttöinen graafinen käyttöalusta ja siihen pitää vain syöttää kohteen osoite.



![nampb](https://github.com/Hamis95/PENTEST/blob/main/dirbuster.png?raw=true)


Jonka jälkee dirbuster alkaa tutkimaan mahdollisia directoreita

![nampb](https://github.com/Hamis95/PENTEST/blob/main/dirbuster2.png?raw=true)

Directorien brute forcaamisessa menee ikuisuus, mutta heti dirbuster löysi /icons/ derectorien, jonne se lähti tekemään lisätiedustelua.


